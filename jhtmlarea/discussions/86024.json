[
  {
    "Id": "292849",
    "ThreadId": "86024",
    "Html": "<p>How do you get a reference to the jHtmlEditor API instance from a popup window opened from the current page?&nbsp; I can get a reference to the textbox the editor is attached to, but I want to call the pasteHtml function on the jHtmlEditor instance at the cursor location.&nbsp; I don't want to modify the text of the underlying textarea directly.</p>\r\n<p>So far I have this in the parent page containing the jHtmlEditor instance (this is a slight modification of ColorPickerMenu.htm in the sample included with the download).&nbsp; I tried creating a local page variable with the instance that clicked the custom toolbar button, but I can't find a reference to that from the popup page either.</p>\r\n<p>&lt;script type=&quot;text/javascript&quot;&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var HTMLAPI; //try to access this from popup<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(function() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(&quot;#Textarea1&quot;).htmlarea({<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolbar: [[&quot;html&quot;],<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [&quot;forecolor&quot;],&nbsp; // &lt;-- Add the &quot;forecolor&quot; Toolbar Button<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [&quot;bold&quot;, &quot;italic&quot;, &quot;underline&quot;], <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [&quot;p&quot;, &quot;h1&quot;, &quot;h2&quot;, &quot;h3&quot;], <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [&quot;link&quot;, &quot;unlink&quot;],<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [{<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;css:&quot;imagegallerybutton&quot;,<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;text:&quot;Image Gallery&quot;,<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;action:function(btn) {<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var url = 'PickFile.htm';<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; HTMLAPI = $(this);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var gallery = window.open(url,'gallery','width=700,height=600,toolbars=0,resizable=1');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;gallery.focus();&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });<br>&nbsp;&nbsp;&nbsp; &lt;/script&gt;</p>\r\n<p>&nbsp;</p>\r\n<p>Here is my popup page in full:</p>\r\n<p>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;<br>&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;<br>&lt;head&gt;<br>&nbsp;&nbsp;&nbsp; &lt;title&gt;Pick a file&lt;/title&gt;<br>&nbsp;&nbsp;&nbsp; &lt;script type=&quot;text/javascript&quot; src=&quot;scripts/jquery-1.3.2.min.js&quot;&gt;&lt;/script&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&nbsp;&nbsp; &nbsp;&lt;script type=&quot;text/javascript&quot;&gt;<br>$(document).ready(function() {<br>&nbsp;&nbsp; &nbsp;$('#insert').click(function(){<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var htmlText = $('#html').val();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var openerID = '#Textarea1';<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var $parent = $(window.opener.document); //this is the root of the parent window document, appears correct in Firebug<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var $editor = $(window.opener.document).find(openerID); //this is the textarea instance, appears correct in Firebug<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$parent.HTMLAPI.pasteHTML(htmlText);<br>&nbsp;&nbsp; &nbsp;});<br>});<br>&nbsp;&nbsp; &nbsp;&lt;/script&gt;<br>&nbsp;&nbsp; &nbsp;&lt;input id=&quot;html&quot; type=&quot;text&quot; value=&quot;Some &lt;b&gt;html&lt;/b&gt;&quot; /&gt;<br>&nbsp;&nbsp; &nbsp;&lt;input id=&quot;insert&quot; type=&quot;button&quot; value=&quot;Insert&quot; /&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</p>\r\n<p>&nbsp;</p>\r\n<p>I have successfully changed $editor to point to a selector of another non-HtmlEditor on the parent page and updated it's value.&nbsp; So I know I have a good reference to elements on the parent page.&nbsp; $parent.HTMLAPI is 'undefined' from the popup.&nbsp; Any ideas how to reference the API of the jHtmlEditor opened from the parent window custom toolbar button?</p>\r\n<p>Thanks,</p>\r\n<p>Michael Lang</p>",
    "PostedDate": "2010-02-19T14:02:43.377-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "315026",
    "ThreadId": "86024",
    "Html": "<p>I found a workaround; although in my opinion, it is not an ideal solution.&nbsp; The calling page (the one with the editor instance(s)) needs the following change.&nbsp; The lines to accomplish each step are <span style=\"color:#ff00ff\">highlighted</span> in purple</p>\r\n<p>1) define a page level variable to hold html area instances.</p>\r\n<p>2) On button click add the current instance to the page level variable as an array member.&nbsp; If your selector creating the 'htmlarea' does not resolve to one entity, then you may want to alter this line to get the id of the textarea attached to this editor and put that as the array key.&nbsp; You don't want multiple editors created by class name, all overriding a given instance in the array.&nbsp; Otherwise you will end up with popups opened from one editor putting content into a different editor.</p>\r\n<p><span style=\"color:#ff00ff\">var jHtmlArea_API = new Object();</span> <span style=\"color:#800080\">//step 1</span><br> $(document).ready(function(){<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$(&quot;#Textarea1&quot;).htmlarea({<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolbar: [[&quot;html&quot;],<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [&quot;forecolor&quot;],&nbsp; // &lt;-- Add the &quot;forecolor&quot; Toolbar Button<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [&quot;bold&quot;, &quot;italic&quot;, &quot;underline&quot;], <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [&quot;p&quot;, &quot;h1&quot;, &quot;h2&quot;, &quot;h3&quot;], <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [&quot;link&quot;, &quot;unlink&quot;],<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [{<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;css:&quot;imagegallerybutton&quot;,<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;text:&quot;Image Gallery&quot;,<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;action:function(btn) {<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span style=\"color:#ff00ff\">jHtmlArea_API['#Textarea1'] = $(this);</span> <span style=\"color:#800080\">//step 2</span><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var url = 'PickFile.htm'; //TODO: add selector to url querystring<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var gallery = window.open(url,'gallery','width=700,height=600,toolbars=0,resizable=1');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gallery.focus();&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });<br>&nbsp;&nbsp; &nbsp;});</p>\r\n<p>Then on the popup page (will be an image gallery in my case), hack your way to down to the editor instance methods.</p>\r\n<p>$(document).ready(function() {<br>&nbsp;&nbsp; &nbsp;$('#insert').click(function(){<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var htmlText = $('#html').val();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var openerID = '#Textarea1'; //TODO: get from the url<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var $parent = $(window.opener);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<span style=\"color:#ff00ff\">$parent[0].jHtmlArea_API[openerID][0].pasteHTML(htmlText);</span><br>&nbsp;&nbsp; &nbsp;});<br>});</p>",
    "PostedDate": "2010-02-20T20:49:31.227-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "477181",
    "ThreadId": "86024",
    "Html": "mlang great script was exactly what i needed and very easy to implement with your instruction. Thx mate. Only problem that has come up for me so far is it does not work in Safari5 or Chrome5. :( Works great in IE8 and Firefox3!!!",
    "PostedDate": "2010-08-05T16:53:55.013-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "485363",
    "ThreadId": "86024",
    "Html": "<p>Did you find out why it did not work?&nbsp; Which line?</p>",
    "PostedDate": "2010-08-26T12:52:19.443-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]